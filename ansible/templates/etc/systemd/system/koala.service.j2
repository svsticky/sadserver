# {{ ansible_managed }}

[Unit]
Description=Run koala {{ koala_env.environment }} service
Wants=mysql.service
After=network.target
OnFailure=failure-notificator@%n.service

[Service]
{% if koala.server == "unicorn" %}
Type=forking
PIDFile=/var/www/koala.{{ canonical_hostname }}/tmp/pids/unicorn.pid
ExecStart=/home/koala/unicorn.sh
{% elif koala.server == "webrick" %}
Type=simple
ExecStart=/home/koala/webrick.sh
{% endif %}
User=koala
Group=www-data
WorkingDirectory=/var/www/koala.{{ canonical_hostname }}
Restart=always

RuntimeDirectory=koala
RuntimeDirectoryMode=0750

[Install]
WantedBy=multi-user.target
